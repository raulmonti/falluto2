OPTIONS
SYSNAME Eleccion_De_Lider_OJO_lo_corri_5_min_y_no_termino_
CHECK_DEADLOCK
--FAULT_SYS_FAIR_DISABLE
--MODULE_WEAK_FAIR_DISABLE
ENDOPTIONS


PROCTYPE Process(myId, idMenos1, maxIMenos1, distIMenos1)
	
	VAR
		maxid: 1..5
		dist: 0..4

	FAULT
		-- Falla de efecto bizantino sobre las variables maxid y dist
		falla: is BYZ(maxid,dist)

	TRANS
	
		[mine0]: myId > maxid => maxid' = myId, dist' = 0;
	    	[mine1]: dist = 0 & maxid != myId => maxid' = myId;
		[mine2]: myId = maxid & dist != 0 => dist' = 0;

		[neighbour]: distIMenos1+1 < 5 & myId < maxIMenos1 => maxid' = maxIMenos1, dist' = distIMenos1 + 1;

		[lider]: distIMenos1+1 >= 5 | (myId > idMenos1 & myId >= maxIMenos1) => maxid' = myId, dist' = 0;

ENDPROCTYPE


INSTANCE proc1 = Process(1,5,proc5.maxid,proc5.dist)
INSTANCE proc2 = Process(2,1,proc1.maxid,proc1.dist)
INSTANCE proc3 = Process(3,2,proc2.maxid,proc2.dist)
INSTANCE proc4 = Process(4,3,proc3.maxid,proc3.dist)
INSTANCE proc5 = Process(5,4,proc4.maxid,proc4.dist)


LTLSPEC G F ((proc1.maxid = 5 & proc2.maxid = 5 & proc3.maxid = 5 & proc4.maxid = 5 & proc5.maxid = 5) 
		& 
	     (proc5.dist = 0 & proc1.dist = proc5.dist + 1 & proc2.dist = proc1.dist + 1 & proc3.dist = proc2.dist + 1 & proc4.dist = proc3.dist + 1 ))
